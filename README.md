# 欢迎来到 $$23giter$$ 喵！

#### 有待被采纳的打飞机方法喵!

喵喵喵！ 

$KU18$系已经上机检测过的内部库,注入了部分内部参数.

$KU17_0$系 @PurineAcetylO 本人开发的内部库,主要强调结构安排,未注入任何参数,未上机测试.

此后注意:凡是版本号带有`_0`的均为非验证过的版本

请各位来访者按照需求取用,请使用熟悉的合作者的库.

喵喵喵！

------

### 人工势场法

本项目在追及控制律中使用了人工势场法进行导引。1986年，Khatib首先提出人工势场法，并将其应用在机器人避障领域。其基本思想是在障碍物周围构建障碍物斥力势场，在目标点周围构建引力势场，被控对象在这两种势场组成的复合场中受到斥力作用和引力作用，斥力和引力的合力指引着被控对象的运动，搜索无碰的避障路径。更直观而言，人工势场法是将障碍物比作是平原上具有高势能值的山峰，而目标点则是具有低势能值的低谷。

本项目中，我们视已经探测到的飞机为引力的源头，而预先被划定的“禁飞区”和“战场边界”为斥力的源头，相比于原先质点化的源头，将引力和斥力的源扩展成为了闭合的边界

对于敌机产生的引力，有:

$$U_{att}(q)=\frac{1}{2} \alpha_1 r^{\beta_1}(q,q_0)$$

其中， $\alpha_{1}$ 和 $\beta_{1}$ 为引力系数和引力幂级

对于禁飞区边界产生的斥力，有：

$$U_{req1}(q)=\alpha_2 (r^{\beta_2}(q,q_{area})-R)$$

其中， $\alpha_{2}$ 和 $\beta_{2}$ 为禁飞区斥力系数和禁飞区斥力幂级,R是禁飞区半径

对于战场边界产生的斥力，有：

$$U_{req2}(q)=\alpha_3 (d^{\beta_3}(q,q_{n/s}))+\alpha_3 (d^{\beta_3}(q,q_{e/w}))$$

其中， $\alpha_{3}$  和 $\beta_{3}$ 为战场边界斥力系数和战场边界斥力幂级

人工势场法作为一种局部路径规划算法，具有规划速度快、局部规划效果好、对环境适应性强等优势 [71]，却存在目标不可达和易陷入局部极小值的缺陷。本章首先阐述传统人工势场法的原理及优缺点，再针对其缺陷提出改进方法，最后通过仿真实验验证改进算法的有效性。4.1 传统人工势场法4.1.1 人工势场法基本原理人工势场法由 Khatib 于 1986 年首次提出，其核心原理是将无人机飞行区域建模为虚拟势力场 [72]。该方法将无人机、障碍物和目标点视为质点，无人机在虚拟力场的作用下沿势能下降方向移动，最终抵达目标点完成路径规划。
如图 4-1 所示，无人机所受虚拟力场由引力势场和斥力势场叠加而成：
引力势场由目标点产生，方向从无人机指向目标点；斥力势场由障碍物产生，方向从障碍物指向无人机。
在飞行环境中，目标点对无人机的引力大小取决于两者距离：距离越远，引力越大；距离越近，引力越小。当无人机进入障碍物影响范围时，障碍物的斥力大小也取决于两者距离：距离越近，斥力越大；距离越远，斥力越小。在引力和斥力的共同作用下，无人机沿虚拟力场的负梯度方向移动，直至到达目标点（如图 4-2 所示）。4.1.2 人工势场法数学模型（1）引力函数数学模型引力势场由无人机与目标点的距离关系确定，表达式为：
\(U_{att}(q)=\frac{1}{2}k_{att}d^{2}(q,q_{g})\quad(4.1)\)
其中，\(U_{att}(q)\)为无人机当前位置的引力势场；\(k_{att}\)为引力势场增益系数；q为无人机当前位置；\(q_g\)为目标点位置；\(d(q,q_g)\)为无人机到目标点的距离。
无人机受到的引力为引力势场函数的负梯度，方向由无人机当前位置指向目标点，表达式为：
\(F_{att}(q)=-\nabla U_{att}(q)=-k_{att}d(q,q_g)\quad(4.2)\)
引力大小与\(d(q,q_g)\)成正比。（2）斥力函数数学模型当无人机处于障碍物影响范围内时，斥力势场由无人机与障碍物的距离关系确定，表达式为：
\(U_{rep}(q)=\begin{cases}\frac{1}{2}k_{rep}\left(\frac{1}{d(q,q_0)}-\frac{1}{d_0}\right)^2,&d(q,q_0)\leq d_0\\0,&d(q,q_0)>d_0\end{cases}\quad(4.3)\)
其中，\(U_{rep}(q)\)为无人机当前位置的斥力势场；\(k_{rep}\)为斥力势场增益系数；\(q_0\)为障碍物位置；\(d(q,q_0)\)为无人机到障碍物的距离；\(d_0\)为障碍物对无人机产生影响的最大范围。
无人机受到的斥力为斥力势场函数的负梯度，方向由障碍物位置指向无人机当前位置，表达式为：
\(F_{rep}(q)=-\nabla U_{rep}(q)=\begin{cases}k_{rep}\left(\frac{1}{d(q,q_0)}-\frac{1}{d_0}\right)\frac{1}{d^2(q,q_0)},&0\leq d(q,q_0)\leq d_0\\0,&d(q,q_0)>d_0\end{cases}\quad(4.4)\)
斥力大小与\(d(q,q_0)\)成反比。
无人机在空间中所受合力为引力与多个障碍物斥力的叠加，合力势场和合力表达式分别为：
\(U_{total}(q)=U_{att}(q)+\sum_{i=1}^{n}U_{rep}(q)\quad(4.5)\)
\(F_{total}(q)=F_{att}(q)+\sum_{i=1}^{n}F_{rep}(q)\quad(4.6)\)
其中，n为环境中障碍物的总个数。4.1.3 人工势场法的优缺点人工势场法的优点包括规划速度快、局部规划效果好、对环境适应性强，在路径规划中应用广泛。但其存在两大核心缺陷：（1）目标不可达问题目标点对无人机的引力与距离正相关（距离越近，引力越小），障碍物的斥力与距离负相关（距离越近，斥力越大）。当目标点附近存在障碍物时（如图 4-3），无人机靠近目标点过程中，引力逐渐减小而斥力逐渐增大，可能出现斥力大于引力的情况，导致无人机远离目标点；随后引力又会因距离增加而增大，使无人机再次飞向目标点，最终在目标点附近往复摆动，无法抵达目标。（2）局部极小值问题在复杂或特殊环境中，无人机可能出现引力与斥力大小相等、方向相反的情况，导致非目标点处合力为零，陷入局部极小值 [73]，具体分为两种场景：
场景一：目标点、障碍物与无人机共线，且障碍物位于目标点和无人机之间（如图 4-4）。此时无人机受到的引力与斥力可能完全抵消，无法向目标点移动。场景二：存在多个障碍物时，无人机所受斥力为多个障碍物斥力的叠加（如图 4-5）。若叠加后的斥力与目标点的引力大小相等、方向相反，无人机将在非目标点处停滞，无法抵达目标。4.1.4 人工势场法实现流程人工势场法用于无人机航迹规划的步骤如下：
对无人机飞行环境进行建模；设置参数：包括引力系数\(k_{att}\)、斥力系数\(k_{rep}\)、障碍物位置\(q_0\)、障碍物影响范围\(d_0\)，以及起始点、目标点和障碍物信息；计算无人机当前位置受到的引力和斥力的大小与方向；计算当前位置所受合力的大小与方向；无人机根据合力移动至下一位置；判断是否到达目标点：若是，记录路径信息并完成规划；否则，返回步骤 3。
具体流程如图 4-6 所示。4.2 人工势场法的改进4.2.1 改进斥力函数传统人工势场法的目标不可达问题源于：无人机接近目标点时引力趋近于零，若附近有障碍物，斥力可能导致目标点处合力不为零。为解决此问题，需在无人机抵达目标点时限制斥力，使其逐渐减小至零。
本文通过引入无人机到目标点的距离因素改进斥力场函数，表达式为：
\(U_{rep}(q)=\begin{cases}\frac{1}{2}k_{rep}\left(\frac{1}{d(q,q_0)}-\frac{1}{d_0}\right)^2d^{\lambda}(q,q_g),&d(q,q_0)\leq d_0\\0,&d(q,q_0)>d_0\end{cases}\quad(4.7)\)
其中，\(d(q,q_g)\)为无人机到目标点的距离；\(\lambda\)为正数常数（本文取\(\lambda=2\)）。
改进后的斥力\(F_{rep}(q)\)表达式为：
\(F_{rep}(q)=-\nabla U_{rep}(q)=\begin{cases}F_{rep1}+F_{rep2},&d(q,q_0)\leq d_0\\0,&d(q,q_0)>d_0\end{cases}\quad(4.8)\)
其中：
\(F_{rep1}=k_{rep}\left(\frac{1}{d(q,q_0)}-\frac{1}{d_0}\right)\frac{1}{d^2(q,q_0)}d^{\lambda}(q,q_g)\)（方向由障碍物指向无人机）
\(F_{rep2}=-\frac{\lambda}{2}k_{rep}\left(\frac{1}{d(q,q_0)}-\frac{1}{d_0}\right)^2d^{\lambda-1}(q,q_g)\)（方向由无人机指向目标点）
当无人机靠近目标点时，\(d(q,q_g)\)趋近于零，\(F_{rep1}\)和\(F_{rep2}\)均逐渐减小至零，确保目标点处合力为零（全局极小值点），使无人机顺利抵达目标（如图 4-7）。4.2.2 改进引力函数针对局部极小值问题，本文从两方面改进引力函数：（1）限制引力当无人机距离目标点较远时，限制引力大小可避免其快速飞向与障碍物共线的区域，减少陷入局部极小值的概率。改进后的引力表达式为：
\(F_{att}(q,q_g)=\begin{cases}-k_{att}d(q,q_g),&d(q,q_g)\leq l_0\\-k_{att}l_0,&d(q,q_g)>l_0\end{cases}\quad(4.11)\)
其中，\(l_0\)为限制引力的距离阈值（如图 4-8）。当距离小于\(l_0\)时，引力与距离成正比；当距离大于等于\(l_0\)时，引力保持恒定。（2）引入逃逸力当无人机陷入局部极小值（合力趋近于零且引力与斥力方向相反）时，引入逃逸力打破平衡。判断无人机陷入局部极小值的条件为：
\(\begin{cases}F_{att}(q)+\sum_{i=1}^{n}F_{rep}(q)<\varepsilon,\varepsilon\to0\\-1\leq\cos(\angle F_{att}(q)-\angle\sum_{i=1}^{n}F_{rep}(q))\leq0\end{cases}\quad(4.12)\)
引入的逃逸力势场为：
\(U_{add}(q)=\begin{cases}-\frac{1}{2}k_{add}\left(\frac{1}{d(q,q_0)}\right)^2,&d(q,q_0)\leq d_a\\0,&d(q,q_0)>d_a\end{cases}\quad(4.13)\)
其中，\(k_{add}\)为逃逸力系数；\(d_a\)为逃逸力影响范围。
逃逸力表达式为：
\(F_{add}(q)=-\nabla U_{add}(q)=\frac{-k_{add}}{d^3(q,q_0)}\quad(4.14)\)
（方向由无人机指向目标点）
改进后的合力为：
\(F_t(q)=F_{att}(q)+F_{add}(q)+\sum_{i=1}^{n}F_{rep}(q)\quad(4.15)\)4.2.3 改进人工势场法实现流程改进人工势场法的流程如下：
对无人机飞行环境进行三维建模；设置参数：包括引力系数\(k_{att}\)、斥力系数\(k_{rep}\)、起始点、目标点及障碍物信息；计算改进后的引力（式 4.11）和斥力（式 4.8）；计算当前位置所受合力的大小与方向；无人机根据合力移动至下一位置；判断是否陷入局部极小值（式 4.12）：若是，引入逃逸力更新合力（式 4.15）并返回步骤 5；否则，执行步骤 7；判断是否到达目标点：若是，记录路径信息并完成规划；否则，返回步骤 3。
具体流程如图 4-9 所示。4.3 仿真结果及分析为验证改进人工势场法的有效性，使用 MATLAB2016a 在 Windows10（64 位）系统（Intel Core i5-4210U 处理器，1.70GHz，4GB 内存）中进行仿真。设置 200×200×100 栅格的三维环境，障碍物为圆柱形，移动步数 300，参数如表 4-1 所示。
参数名称参数含义数值势场引力系数\(k_{att}\)0.1势场斥力系数\(k_{rep}\)0.4逃逸力系数\(k_{add}\)0.1障碍物影响距离\(d_0\)6逃逸力范围\(d_a\)5常数\(\lambda\)2柱状障碍物半径-5移动步长-34.3.1 第一组实验（验证目标不可达问题解决效果）设置单障碍物静态环境：起始点 (10,10,0)，目标点 (150,150,40)，障碍物 (160,160,50)，\(l_0=100\)。
传统人工势场法：无人机在目标点附近因斥力大于引力而停滞，无法到达目标（如图 4-10）。改进人工势场法：通过改进斥力函数，无人机靠近目标点时斥力快速减小，顺利抵达目标（如图 4-11）。4.3.2 第二组实验（验证局部极小值问题解决效果）（1）环境一（单障碍物共线场景）目标点 (180,180,40)，障碍物 (160,160,50)，\(l_0=100\)。
传统方法：无人机因引力与斥力抵消而陷入局部极小值（如图 4-12）。改进方法：通过限制引力和引入逃逸力，无人机摆脱停滞，抵达目标（如图 4-13）。（2）环境二（双障碍物对称场景）两个障碍物分别为 (120,150,50) 和 (150,120,50)，目标点 (180,180,40)。
传统方法：无人机受对称斥力与引力抵消，陷入局部极小值（如图 4-14）。改进方法：通过改进引力函数，无人机成功避开障碍物并到达目标（如图 4-15）。（3）复杂环境验证随机设置多个障碍物，改进算法仍能规划出无碰撞路径（如图 4-16），进一步验证了其有效性。4.4 本章小结本章针对传统人工势场法在无人机三维航迹规划中存在的目标不可达和局部极小值问题，提出了改进方法：
通过引入无人机到目标点的距离因素改进斥力场函数，解决目标不可达问题；采用引力势场限制策略和引入逃逸力改进引力场函数，解决局部极小值问题。
仿真实验验证了改进人工势场法的有效性，为后续算法融合奠定了基础。编辑分享
